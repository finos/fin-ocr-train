# MICR Training with ocr cli generated Data

This guide provides a practical and simple example of setting up and running a Tesseract OCR training session for MICR Lines using synthetic data generated by `ocr cli`. The process can be adapted for your specific training needs and primarily serves as an example of how to get started with the end to end process. Please refer to the [training with real data](../real/README.md) for an example of how to train with real check images.


## Prerequisites

* **Node.js** and npm (for running the OCR CLI tool)
* **gmake** or **make** v4.2 or newer
* **Python 3.x** along with the `pillow` library for image processing.
* **wget**
* **Tesseract 5.x** (see [Tesseract installation instructions](https://tesseract-ocr.github.io/tessdoc/Installation.html))
* **OCR CLI tool** (follow installation instructions from the [fin-ocr-cli repository](https://github.com/finos/fin-ocr-cli))

## Starting a Training Session

We'll use the OCR CLI tool to generate check images and corresponding ground truth data.

1. Set up your environment (OPTIONAL)
   ```
   export TRAIN_DIR=$HOME/.fin-ocr/train 
   ```
2. Running the Training Script
The included mgr script in this directory automates the entire training process, from generating synthetic data to training the Tesseract model. To run the script:
```bash
 ./mgr train <numSamples> [<model-name>]
```
* `<numSamples>`: The number of synthetic MICR samples to generate and use for training.
* `[<model-name>]`: (Optional) The name of the model to train. Defaults to micr_e13b.

This will initiate the training process using 1000 generated micr line images.


## What Happens During Training

1. The `mgr` script sets up the training environment:
   - Clones the [tesstrain](https://github.com/tesseract-ocr/tesstrain) repository if not present
   - Downloads necessary language data files

2 Generates Synthetic Training Data: The script uses the OCR CLI tool to generate synthetic MICR line data, which is then used for training.

3. Starts the Training Process: The script invokes the tesstrain makefile to train the model using the generated data. The results, including the trained model file (.traineddata), are saved to a results directory.

## Training Results

After training completes:

1. Results are stored in `$TRAIN_DIR/results/<date>/`:
   - `micr_e13b.traineddata`: The trained Tesseract data file (model name)

2. You can use the resulting `micr_e13b.traineddata` file with the [fin-ocr CLI](https://github.com/finos/fin-ocr-cli) or [fin-ocr REST service](https://github.com/finos/fin-ocr-rest) for MICR line recognition.

